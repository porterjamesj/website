{{ define "main" }}

{{ $pages := .CurrentSection.Pages }}

<div class="article">
  <div class="ba b--silver br2 pa2 flex justify-between">
    {{ with $pages.Next . }}
      <a href="{{ .RelPermalink }}" class="no-underline"><span class="f4">⬻</span> Prev</a>
    {{ else }}
      <div style="width: 2em;"></div>
    {{ end}}
    {{ with .Date }}{{ .Format "Monday, January 2" }}{{ end }}
    {{ with $pages.Prev . }}
      <a href="{{ .RelPermalink }}" class="no-underline">Next <span class="f4">⤖</span></a>
    {{ else }}
      <div style="width: 2em;"></div>
    {{ end }}
  </div>

  <h2>{{ .Title }}</h2>

<!-- store the beginning of the footnotes specific HTML generated by the Markdown processor into a variable -->
{{ $footnotes_tag:= `<div class="footnotes" role="doc-endnotes">` }}

{{ if strings.Contains .Content $footnotes_tag }}

  <!-- split content and store the result into a variable -->
  {{ $split := split .Content $footnotes_tag }}

  <!-- render content before footnotes -->
  {{ index $split 0 | safeHTML }}

  <div class="ba b--silver br2 pa2 mt3 flex justify-between">
  {{ with $pages.Next . }}
    <a href="{{ .RelPermalink }}" class="no-underline"><span class="f4">⬻</span> Prev</a>
  {{ else }}
    <div style="width: 2em;"></div>
  {{ end }}
  <a href="{{ .CurrentSection.RelPermalink }}" class="no-underline">{{ .CurrentSection.Title }}</a>
  {{ with $pages.Prev . }}
    <a href="{{ .RelPermalink }}" class="no-underline">Next <span class="f4">⤖</span></a>
  {{ else }}
    <div style="width: 2em;"></div>
  {{ end }}
  </div>

  <!-- render footnotes -->
  {{ $footnotes_tag | safeHTML }}{{ index $split 1 | safeHTML }}

{{ else }}
  {{ .Content }}

  <div class="ba b--silver br2 pa2 mt3 flex justify-between">
  {{ with $pages.Next . }}
    <a href ="{{ .RelPermalink }}" class="no-underline"><span class="f4">⬻</span> Prev</a>
  {{ else }}
    <div style="width: 2em;"></div>
  {{ end }}
  <a href="{{ .CurrentSection.RelPermalink }}" class="no-underline">{{ .CurrentSection.Title }}</a>
  {{ with $pages.Prev . }}
    <a href ="{{ .RelPermalink }}" class="no-underline">Next <span class="f4">⤖</span></a>
  {{ else }}
    <div style="width: 2em;"></div>
  {{ end }}
  </div>

{{ end }}

</div>

{{ end }}
