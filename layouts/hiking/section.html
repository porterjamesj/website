{{ define "main" }}

<div class="article">
  <h2>{{ .Title }}</h2>

<!-- store the beginning of the footnotes specific HTML generated by the Markdown processor into a variable -->
  {{ $footnotes_tag:= `<div class="footnotes" role="doc-endnotes">` }}

{{ if strings.Contains .Content $footnotes_tag }}

  <!-- split content and store the result into a variable -->
  {{ $split := split .Content $footnotes_tag }}

  <!-- render content before footnotes -->
  {{ index $split 0 | safeHTML }}

  <!-- render index -->
  <ol>
    <!-- Ranges through content/posts/*.md -->
    {{ range .Pages }}
    <li>
      <a href="{{ .RelPermalink }}">{{ .LinkTitle }}</a>
    </li>
    {{ end }}
  </ol>

  <!-- render footnotes -->
  {{ $footnotes_tag | safeHTML }}{{ index $split 1 | safeHTML }}

{{ else }}
  {{ .Content }}
  <!-- render index -->
  <ol>
    <!-- Ranges through content/posts/*.md -->
    {{ range .Pages }}
    <li>
      <a href="{{ .RelPermalink }}">{{ .LinkTitle }}</a>
    </li>
    {{ end }}
  </ol>
{{ end }}
</div>

{{ end }}
